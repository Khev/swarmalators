(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    163046,       4201]
NotebookOptionsPosition[    157216,       4090]
NotebookOutlinePosition[    157642,       4107]
CellTagsIndexPosition[    157599,       4104]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction", "Section",
 CellChangeTimes->{{3.8629486453105097`*^9, 
  3.862948647501163*^9}},ExpressionUUID->"bbdf1c67-7c07-464c-9dea-\
dd1ce40e9098"],

Cell["\<\
Can we analyze the sync state using the technique in \
\[OpenCurlyDoubleQuote]Collective dynamics of coupled oscillators with random \
pinning\[CloseCurlyDoubleQuote] section 2.1?\
\>", "Text",
 CellChangeTimes->{{3.864306529313703*^9, 3.864306555991584*^9}, {
  3.864306708852466*^9, 3.864306777662291*^9}, {3.864818864352013*^9, 
  3.8648188647015553`*^9}, {3.8648190338539886`*^9, 
  3.864819039172277*^9}},ExpressionUUID->"150ede99-bd58-4f5d-9d77-\
60e362fa9b38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Look at state", "Section",
 CellChangeTimes->{{3.8648189105191727`*^9, 
  3.864818911621245*^9}},ExpressionUUID->"172b6825-64c5-493e-8d5c-\
2bdf4881ad52"],

Cell[CellGroupData[{

Cell["Scatter plots", "Subsection",
 CellChangeTimes->{{3.864818945990745*^9, 
  3.864818949552828*^9}},ExpressionUUID->"9cfc27a6-c0d8-43b5-b8a0-\
6951a153c00f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Preamble", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dt", ",", "n", ",", "T"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.25", ",", "100", ",", "500"}], "}"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J", ",", "k"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", ",", "b"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.25"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ex", ",", "E\[Theta]"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"e", ",", "e"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b1", ",", "b2"}], "}"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"b", ",", "b"}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z0", ",", "pin", ",", "znew"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.99", "\[Pi]"}], ",", 
            RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], "}"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"z", " ", "=", " ", 
      RowBox[{"[", 
       RowBox[{"x", ",", "\[Theta]"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pin", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"2", " ", "Pi", " ", 
           RowBox[{"i", " ", "/", " ", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z00", " ", "=", " ", "z0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"results", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "[", "results", "]"}], " ", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "dynamic", " ", "plotting"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "NT"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"T", "/", "dt"}], "]"}]}], "}"}]}], " ", ";", " ", 
    RowBox[{"(*", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"number", " ", "of", " ", "timesteps"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Main", " ", "sim"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"t", "<", "NT"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"znew", "=", 
        RowBox[{"rk4", "[", 
         RowBox[{
         "z0", ",", "rhs", ",", "dt", ",", "J", ",", "k", ",", "Ex", ",", 
          "E\[Theta]", ",", "pin", ",", "b1", ",", "b2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"z0", "=", "znew"}], ";", 
       RowBox[{"t", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"results", "=", 
        RowBox[{"plotResults", "[", 
         RowBox[{"znew", ",", "pin"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.864818916863613*^9, 3.8648189299270906`*^9}, {
  3.864819354886951*^9, 3.864819356065074*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"cebf396b-dd37-4c2b-bec3-df07c761872a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.25`", ",", "0.25`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8648189223517523`*^9, 3.864818930712059*^9}, 
   3.864819356581211*^9},
 CellLabel->
  "Out[385]=",ExpressionUUID->"a1527836-81ec-4e32-91d3-1c91d3b194d2"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`results, StandardForm],
  ImageSizeCache->{1836., {183.634033203125, 189.365966796875}}]], "Output",
 CellChangeTimes->{{3.8648189223517523`*^9, 3.864818930712059*^9}, 
   3.8648193565981817`*^9},
 CellLabel->
  "Out[389]=",ExpressionUUID->"dc3dfb2c-2cb1-4e17-94cf-4cf382ff489c"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.8648189223517523`*^9, 3.864818930712059*^9}, 
   3.8648193607968693`*^9},
 CellLabel->
  "Out[390]=",ExpressionUUID->"833503bc-0165-45bf-84fa-d2282d59bdbb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["S(b) for K  = 2", "Subsection",
 CellChangeTimes->{{3.864818952684093*^9, 3.8648189535680847`*^9}, {
  3.864819042344681*^9, 
  3.8648190444348707`*^9}},ExpressionUUID->"2ff92a82-3890-4af4-a315-\
0ddce8ebaf72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dt", ",", "n", ",", "T"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "200", ",", "100"}], "}"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"J", ",", "k"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ex", ",", "E\[Theta]"}], "}"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", "b1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b1", ",", "b2"}], "}"}], " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"b", ",", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z0", ",", "pin", ",", "znew"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], "}"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"z", " ", "=", " ", 
        RowBox[{"[", 
         RowBox[{"x", ",", "\[Theta]"}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pin", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"2", " ", "Pi", " ", 
             RowBox[{"i", " ", "/", " ", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z00", " ", "=", " ", "z0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "NT"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"T", "/", "dt"}], "]"}]}], "}"}]}], " ", ";", " ", 
      RowBox[{"(*", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"number", " ", "of", " ", "timesteps"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Wps", ",", "Wms"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"t", "<", "NT"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"znew", "=", 
          RowBox[{"rk4", "[", 
           RowBox[{
           "z0", ",", "rhs", ",", "dt", ",", "J", ",", "k", ",", "Ex", ",", 
            "E\[Theta]", ",", "pin", ",", "b1", ",", "b2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z0", "=", "znew"}], ";", 
         RowBox[{"t", "++"}], ";", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Wp", ",", "Wm"}], "}"}], "=", 
          RowBox[{"findWs", "[", "znew", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"AppendTo", "[", 
          RowBox[{"Wps", ",", "Wp"}], "]"}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"Wms", ",", "Wm"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"cutoff", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"0.75", 
         RowBox[{"Length", "[", "Wps", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Sp", ",", "Sm"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Wps", "[", 
            RowBox[{"[", 
             RowBox[{"cutoff", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "Abs"}], "//", 
          "Mean"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Wms", "[", 
            RowBox[{"[", 
             RowBox[{"cutoff", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "Abs"}], "//", 
          "Mean"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Sp", "<", "Sm"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Sp", ",", "Sm"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{"Sm", ",", "Sp"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"b1", ",", "Sp", ",", "Sm"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1.5"}], ",", "1.5", ",", "0.025"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8648189990178556`*^9, 3.864819020520651*^9}, {
  3.8648194516387873`*^9, 
  3.8648194518982964`*^9}},ExpressionUUID->"c008f08a-2d3f-47ab-a43a-\
58420013416a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"data1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<b\>\"", ",", "25", ",", "Italic"}], "]"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(S\), \(+\)]\)\>\"", ",", "17", ",", 
         "Italic"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(S\), \(-\)]\)\>\"", ",", "17", ",", 
         "Italic"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"AxesStyle", "\[Rule]", "15"}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<K = 2\>\"", ",", "16", ",", "Italic"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.25"}], ",", "0.8"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<static phase \\n wave\>\"", ",", "12"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.25", ",", "0.5"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<sync\>\"", ",", "13"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.4", ",", "0.5"}], "}"}]}], "]"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.1"}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864819218272085*^9, 3.864819320618949*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"5e3a04ff-1fca-4ba3-9945-ede260cd44ed"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        PointBox[CompressedData["
1:eJxF1X9M1GUcB/AzJXNr1GIoU+fW8NQhBWamA+lT4+QPaaWHChYtAjTMCG3L
ZLk4vBplgUKhwICILdFCWN38ATE/Ljjk1x2/TpTiLvnN8et7dxx3/LjD7r7P
9/PwbLfbs+d5Xs/31/P+vJiYpjz2lEwmS/f8vP+szeFn7628tfREgKJCb3Oi
Mvn0VW9/p9icuHbTxXxvX9fmbQ6cP/mK2ts/LjYHajYGpXn7zHNg50d7jy57
szjuI39z2ZvF3Q15W5Y9O25O2bxm2bOj7WrymJt7dnzL2FDv5t4MrnnucpGb
ezMYq35y0s09G1qXrK+5uWfDY4FrF1zcs2GTRqNxcc+KX0DOhy7uWXFH+R8y
F/csqIyQZy9yz4KLeWdWLHLPgq1ZsiMLfL2A0aN3M+b5/GlUlCs/nfP0xe0K
p9D4seoZp6cv8m2TGN1aIZ/l3iQa/BpVNu5N4O2W1OJp7o1jSUycaox7ZlQW
HXEbuTeGhc+v1zdzbwytdTf+vMy9Ubzz04SvL/dG8LRxbqtikbxhjDnwUvNq
HXlD2Be59+LZ++QNYQpmHZ3WkjeIVV3PHvpNS94Adh3Sl/lpyetH/1ttuSGN
5D3GcN/zxtxG8h6jSr01LblZgGRxvQn1Lb9mYwPN78P6eP+MO575r4r7/YsB
US/fVtcJUCD6vZha+V1dvo68Rxj3euh/0Q3k9aAicKMz/AF5Bgztb71h6BYg
VPS6sdWn5R9FL3mdWC5/u+STPvI6UB0Y4rd6SIAmBmBV1kCpj5nmN2NOrLnd
MCVAgrhfI1ZYnP2nLOTXY0xsl3zbDHn30FERWdvqEOCSuL4GMw+mh8eZab4G
d02t0+7xvA+VOH4dVbW6s7lu6hdi/P7Pkyr5+5XJnmbfIdxj41Dc8YPmume8
jK2H8obE2vAlAd5gPnz5y4qb+jkarwHd344zgwv8+mB92OSFKM/972HXD9th
Jv6hXYAUdn8w0129O8RC65vhx4Urna5JATrY84ERufP7EjN/frD/qxeClgYE
KGbPFyIPdr2rMdL77Aa81qUbNNF6A6yMTi+e76T9eqA94PA3Qe38/cK3hry8
4Qfk9cKWhLCE0Sb+fYDsVE51p568PgjOd57fqSPPBBdiCxKPI//+4PCuiOx1
dfz7hNjIsIiM++T3w9SGK8pzjbR+AFIf9vgKWtpvECJXqff9ruXnA/46saHE
Oy6dH8gf2Vf9NfeG4dGo4m5mC3kjYHtfIQ+ZI28UTJuiqsxL/PxCcGnwtoLl
8w07Lv1c6j3fzDOD6YMal/f8M28c/HtXZXrzgXkTUBKgEvNDyhcYPNEi5gt7
PpNwc/s1MX+YNwVJSSyfmDcN58pYfjFPgEop36T8A5OUf2y+BSgf9Sw/4R0p
P9l6K1C+SvkLlL9SPgPlM/NsQPnNPBtQvjNvBij/pfoAVB+k+gFUP5hnB6ov
zLMD1R/mzQLVJ6l+AdUvqb4B1TfmOYDqH/McQPWReU6g+inVV6D6KtVfoPr7
PziFClg=
         "]]}, {
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        PointBox[CompressedData["
1:eJw91QtMU1cYB/ACCT4YrzWjSIybERNNhlPYZDrjZ1V0wKJWYhxjMidMZQyY
I+J0ONwAQSeIwBqqRjbYRJqBok7UyT4ygivKoyCTh8Ckhbb0dYEWEByw9p6v
nKRpmnvO77S39/z/Sw8k7f7MWSAQHLe97O9svMA2ca+wfVc6XJTZxwT2DxwL
n5SlQxA/JjB94qlhSJsOTY32MY4fHih1WfZeBhzkxzjKdieuDyrMAOaNY1P6
Ytc/LRnkjWGKtPdi2keZ5I1hucqjQdKQSZ4V62Gje6D4NHlWFLs0B4TWnSbP
itEXYlTWXVnkWTBzVv5WuyGLPAsWWZtiO37MJm8UQ/Y9WrBHcoa8UeyuOlK8
fOlZ8kaxouquWTH/B/JG8LF0eqrolXPkjSBElii8AnPIG8bIFXGy1adyyRtG
tfPBtHmCPPKGUblgpWtnXx6t57DXsqrz6sAFmm/GrxWbSysXFwC/ncyEs1Of
3OakhcDzjUbUBB792TVeSp4R3xT7d+yoKSLPgCcL5of1Ky6Rp8eQLz4WH7AW
kzeE4zGTradcSsnTYZtUksfVlJGnw+IEX64z6gZ5WjSdV3uIzt4lT4P3I7Yn
izwekzeImHnX1ecdDXkD2JJ/tLh+UkveAO68o/CvatWRp0ajKFrgLx8iT4XX
ymTnPV/Xk9eP1RXb1hU06sl7jgvzT+TPbjCQ9xxDqryn6joNEMuv78N4p7Qm
kd5A83vQzSOtURhphLf5/Z5hTXIb9+0aIxTxfhcempXU1q0wkdeJy7bsseQI
TeQ9xYzv/s306jaR147+8FtJ838mWM17TzDVRy9Q7TCT14ovQvOPeJ8xk6dE
cF+V6tRtBgUDMHndpZuq1zia34BCN+G15FAO9vP7PcSMKuFfMwkc+XXYLtV9
nlXEkVeLi2c9P62s5iCPX38PX0Yu2RGldsy/hX4zwb//ouXgFH+9HNf6xpTn
jTk+y9DXeSbff9rhCQSDs/bBQS27Dl++HE1dbrv+E1sPwY+cXFVWDjYxH0Sa
3ulFesf1e5Bbfcuvp3Xu+8GdzK3yvjYO3mXfH/LXD5RUSjk4zH4fKFO0fdok
x/oG8LuyJTxiKwdKdn+geWLKSezr8JSgO3Zpp+gfM1xm9xfcQq6sSS0w0//5
BK4qdrp6HzPT+nbwDJqMecaZaL+nUPnHg5F9ZXP/LyTuffRQUGkirwsOrb18
fYOzyfF8QLVlcPUHU0byemCqbm3edbmRvD5wr2/1i0qYe/4gsX//wtDHc88n
TG+Wy3fHGsjvh7j2iNyV3Xpar4JOyVc1FRI97aeGTT2Ldh22Pf90PsAz26cx
qU3nOD8QnlKeUjBPR94ghCY0RYm7NORpYGlDYeT3klbytDBU67FdHn7fcX6h
Qjj/eA7ccJxvEJ2c4Mx/l5E3BBVjLaVy2/lnnh68qk8qLZZi8gwQfE4lf2LL
D8oXKFMmBoTb8oXdHyPs1RRvs+cP80wwHL/kgT2fmGeGmOSwX+35xTwOKqpr
Ouz5RvkH2bGv8vnH5g/DidssH5tZfoLhm8N8frL1I7A1muUr5S8EXWH5S/kM
cTdZPjNvFMoov5k3CgGU78yzwPtjLP+pH2BmmvUD9QeEUX8wzwoBzqxfmGcF
9UbWP8wbgyI16yfqL2ih/qJ+gy7qN+aNg3sE6z/mjUN0DOtH5k3YzgPrT+pX
6KN+pf6FNzaz/v0fO/e11A==
         "]]}}}, {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {
       FormBox[
        StyleBox["\"b\"", 25, Italic, StripOnInput -> False], 
        TraditionalForm], None}, AxesOrigin -> {0, 0}, AxesStyle -> 15, 
     DisplayFunction :> Identity, Epilog -> {
       InsetBox[
        FormBox[
         StyleBox["\"K = 2\"", 16, Italic, StripOnInput -> False], 
         TraditionalForm], {-1.25, 0.8}], 
       InsetBox[
        FormBox[
         StyleBox["\"static phase \\n wave\"", 12, StripOnInput -> False], 
         TraditionalForm], {1.25, 0.5}], 
       InsetBox[
        FormBox[
         StyleBox["\"sync\"", 13, StripOnInput -> False], TraditionalForm], {
        0.4, 0.5}]}, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> Medium, 
     Method -> {
      "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, PlotRange -> {{0, 1.5}, {0, 1.1}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
       StyleBox[
       "\"\\!\\(\\*SubscriptBox[\\(S\\), \\(+\\)]\\)\"", 17, Italic, 
        StripOnInput -> False], 
       StyleBox[
       "\"\\!\\(\\*SubscriptBox[\\(S\\), \\(-\\)]\\)\"", 17, Italic, 
        StripOnInput -> False]}, "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.86481923428724*^9, 3.864819320817974*^9}},
 CellLabel->
  "Out[380]=",ExpressionUUID->"fb54cbac-7c9c-4ba7-a410-60e5b11abd06"]
}, Open  ]],

Cell[TextData[{
 "1. So it looks like ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["S", "+"], "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "77a0fd57-3548-416f-9184-2f807358407f"],
 " for all ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "276ee967-9d61-4bf5-a91e-0377252c4d71"],
 ". Use this."
}], "Text",
 CellChangeTimes->{{3.864819342660796*^9, 3.86481934583936*^9}, {
  3.86481942395949*^9, 
  3.864819433841872*^9}},ExpressionUUID->"4dd082f7-1657-4f70-a5f4-\
a788e93fdef3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fixed points: via exponentials ", "Section",
 CellChangeTimes->{{3.862948649944035*^9, 3.8629486502735863`*^9}, {
  3.862950026907597*^9, 3.862950030089984*^9}, {3.8648185604258966`*^9, 
  3.8648185634953613`*^9}},ExpressionUUID->"ff4b5534-c451-444b-be19-\
aa8b138f9f7d"],

Cell["Goal: parameterize the fixed points in terms of exponentials", "Text",
 CellChangeTimes->{{3.8643067407368383`*^9, 
  3.864306755251437*^9}},ExpressionUUID->"56084902-fdfc-408b-b118-\
dfb23a05ee1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e1", "=", 
   RowBox[{
    RowBox[{
     FractionBox["b", 
      RowBox[{"2", " ", "\[ImaginaryI]"}]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"x", "-", "\[Alpha]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"x", "-", "\[Alpha]"}], ")"}]}]]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[ImaginaryI]"}]], "sp", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "+", "\[Theta]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "+", "\[Theta]"}], ")"}]}]]}], ")"}]}],
     "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[ImaginaryI]"}]], "sm", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "x", "-", "\[Theta]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "-", "\[Theta]"}], ")"}]}]]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", 
   RowBox[{
    RowBox[{
     FractionBox["b", 
      RowBox[{"2", " ", "\[ImaginaryI]"}]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "-", "\[Alpha]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "-", "\[Alpha]"}], ")"}]}]]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["k", 
      RowBox[{"4", " ", "\[ImaginaryI]"}]], "sp", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "+", "\[Theta]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "+", "\[Theta]"}], ")"}]}]]}], ")"}]}],
     "-", 
    RowBox[{
     FractionBox["k", 
      RowBox[{"4", " ", "\[ImaginaryI]"}]], "sm", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "x", "-", "\[Theta]"}], ")"}]}]], "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Phi]p", "-", "x", "-", "\[Theta]"}], ")"}]}]]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"{", 
    RowBox[{"e1", ",", "e2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es1", "=", 
   RowBox[{"simplifyExponents", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"es", "*", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "x"}]], "*", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es1", "=", 
   RowBox[{"es1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "x"}]], "\[Rule]", 
       RowBox[{"z", "^", "2"}]}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], "\[Rule]", 
       RowBox[{"w", "^", "2"}]}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"x", "+", "\[Theta]"}], ")"}]}]], "\[Rule]", 
       RowBox[{
        SuperscriptBox["z", "2"], 
        SuperscriptBox["w", "2"]}]}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Phi]p"}], ")"}]}]], "\[Rule]", 
       RowBox[{
        SuperscriptBox["w", "2"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]p"}]]}]}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"x", "+", "\[Phi]p"}], ")"}]}]], "\[Rule]", 
       RowBox[{"z", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]]}]}], ",", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Theta]", "+", "\[Phi]p"}], ")"}]}]], "\[Rule]", 
       RowBox[{"w", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]]}]}]}], " ", "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"es1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"es1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es2", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{"es2", ",", 
     RowBox[{"{", 
      RowBox[{"w", ",", "z", ",", 
       RowBox[{"w", " ", "z"}], ",", 
       RowBox[{"w", " ", 
        SuperscriptBox["z", "2"]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "es2", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.862948653425837*^9, 3.862948756359457*^9}, {
   3.862949971111478*^9, 3.8629500198380747`*^9}, {3.8629503193649397`*^9, 
   3.862950321314681*^9}, {3.862950419235867*^9, 3.862950420071417*^9}, {
   3.862950528760047*^9, 3.862950534522173*^9}, {3.8629507091983767`*^9, 
   3.862950715796628*^9}, {3.862950769998304*^9, 3.862950774923731*^9}, 
   3.862951045374792*^9, {3.8629511421965923`*^9, 3.8629511447187977`*^9}, {
   3.862951317920599*^9, 3.862951326480631*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"b303af35-7a48-4308-b8c9-02e38ee0a7c6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Phi]m", "+", "\[Phi]p"}], ")"}]}]}]]}], " ", "sm"}], 
       "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", "sp", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]}]]}], "-", 
          RowBox[{"2", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]], " ", 
           SuperscriptBox["z", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["w", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]p"}]}]]}], " ", 
           "sp"}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", "sm", " ", 
           SuperscriptBox["z", "2"]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Phi]m", "+", "\[Phi]p"}], ")"}]}]}]], " ", "k", " ", 
        "sm"}], "+", 
       RowBox[{"2", " ", "b", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]}]], " ", "z"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", "k", " ", "sp", 
        " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["w", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]p"}]}]]}], " ", 
           "k", " ", "sp"}], "-", 
          RowBox[{"2", " ", "b", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Phi]p"}]], " ", "z"}], "-", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", "k", " ", "sm", 
           " ", 
           SuperscriptBox["z", "2"]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.862948757015872*^9, {3.8629499744368963`*^9, 3.8629500200750713`*^9}, {
   3.862950317249329*^9, 3.8629503215410137`*^9}, 3.8629504205100117`*^9, 
   3.862950534743355*^9, {3.862950710756774*^9, 3.8629507159381943`*^9}, {
   3.8629507728119097`*^9, 3.862950775904827*^9}, 3.862950974204062*^9, 
   3.8629510468692007`*^9, {3.862951128961842*^9, 3.8629511449148912`*^9}, 
   3.8629513303056097`*^9, {3.862954190825982*^9, 3.862954195877372*^9}},
 CellLabel->
  "Out[18]//TableForm=",ExpressionUUID->"c721451f-3fbf-4e4f-be9c-\
fd6743fc2edf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Warm up: b = 0", "Subsubsection",
 CellChangeTimes->{{3.8629510059774437`*^9, 
  3.862951008157301*^9}},ExpressionUUID->"0928f760-a724-4615-bfde-\
3e9cf9114d59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"es3", "=", 
  RowBox[{
   RowBox[{"es2", "/.", 
    RowBox[{"b", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"\[Alpha]", "\[Rule]", "0"}]}]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"9fabe89b-96c6-49f5-9e6f-15c908559303"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]m", "+", "\[Phi]p"}], ")"}]}]]}], " ", "sm"}], "+", 
    RowBox[{"sp", " ", 
     SuperscriptBox["z", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["w", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]p"}]]}], " ", "sp"}],
        "+", 
       RowBox[{"sm", " ", 
        SuperscriptBox["z", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"\[Phi]m", "+", "\[Phi]p"}], ")"}]}]], " ", "k", " ", "sm"}], 
    "+", 
    RowBox[{"k", " ", "sp", " ", 
     SuperscriptBox["z", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["w", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]p"}]]}], " ", "k", 
        " ", "sp"}], "-", 
       RowBox[{"k", " ", "sm", " ", 
        SuperscriptBox["z", "2"]}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8629510280528727`*^9, {3.862951130941235*^9, 3.862951148885358*^9}, 
   3.86295133242034*^9, 3.8629541981433496`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"62e61220-7ff6-4655-a69e-ec862827c8f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"es3", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"w", ",", "z"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.862950724386538*^9, 3.8629507294837017`*^9}, {
  3.862950782444023*^9, 3.8629507825692673`*^9}, {3.8629508779079113`*^9, 
  3.8629508816282177`*^9}, {3.86295099132524*^9, 3.862951003841214*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"18ed0232-8555-43a7-8de0-b5a441cf348f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "+", 
           RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}]}], 
     RowBox[{"z", "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]m", "+", 
          RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]},
    {
     RowBox[{"w", "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]m", "-", "\[Phi]p"}], ")"}]}]]}], 
     RowBox[{"z", "\[Rule]", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]m", "+", 
          RowBox[{"3", " ", "\[Phi]p"}]}], ")"}]}]]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.862950734085504*^9, 3.8629507897729483`*^9, 3.8629509312548037`*^9, {
   3.86295099175624*^9, 3.862951004126598*^9}, {3.862951133570795*^9, 
   3.862951151588593*^9}, 3.862951334079343*^9, 3.862954199485805*^9},
 CellLabel->
  "Out[20]//TableForm=",ExpressionUUID->"a14af793-0546-4bbf-9696-\
2d1a3d09325f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"es2", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"sp", "\[Rule]", 
      SubscriptBox["S", "+"]}], ",", 
     RowBox[{"sm", "\[Rule]", 
      SubscriptBox["S", "-"]}], ",", 
     RowBox[{"\[Phi]p", "\[Rule]", 
      SubscriptBox["\[Phi]", "+"]}], ",", 
     RowBox[{"\[Phi]m", "\[Rule]", 
      SubscriptBox["\[Phi]", "-"]}], ",", 
     RowBox[{"k", "\[Rule]", "K"}]}], "}"}]}], "//", "TeXForm"}]], "Input",
 CellChangeTimes->{{3.86295497821196*^9, 3.862955045604945*^9}, 
   3.862955088256538*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"4d3b187f-a78c-452f-84b6-6fea2c54c278"],

Cell["\<\
w^2 \\left(-2 b z e^{i \\phi _+}-K S_+ e^{i \\alpha +2 i \\phi _+}-e^{i \
\\alpha } K S_- z^2\\right)+2 b z e^{2 i \\alpha +i \\phi _+}+K S_- e^{i \
\\alpha +i \\left(\\phi _-+\\phi _+\\right)}+e^{i \\alpha } K S_+
   z^2\
\>", "Output",
 CellChangeTimes->{{3.862954979009982*^9, 3.862955045796606*^9}, 
   3.862955088529615*^9},
 CellLabel->
  "Out[41]//TeXForm=",ExpressionUUID->"3fcdebee-1515-4453-aad1-2e18fe4c352a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Warm up: \[Phi]+=\[Phi]-=0", "Subsubsection",
 CellChangeTimes->{{3.862951015611761*^9, 3.862951023395645*^9}, {
  3.8629516249158382`*^9, 
  3.862951632641736*^9}},ExpressionUUID->"5ba74483-bf5e-4ecc-8225-\
0bd0191fb14c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"es3", "=", 
   RowBox[{"es2", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Phi]m", "\[Rule]", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fp", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"es3", "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"w", ",", "z"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.862951063651499*^9, 3.862951099591906*^9}, {
  3.862951576288378*^9, 3.862951576610045*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"28ee950d-13a1-4706-a130-eeaa9d9bdd41"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"w", "\[Rule]", 
              RowBox[{"Root", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["b", "2"]}], " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                   " ", "sm", " ", "sp"}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                   " ", 
                   SuperscriptBox["k", "2"], " ", 
                   SuperscriptBox["sm", "2"], " ", 
                   SuperscriptBox["sp", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sp"}], "-", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"], " ", "sp"}], "-", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", "#1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    SuperscriptBox["b", "4"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]]}], 
                    "-", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["sm", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm", " ", "sp"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", "sp"}], "-", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["sp", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]], " ", "sp"}], "+", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]], " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"], " ", "sp"}], "+", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "3"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}], 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], 
                   TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", "sm"}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sp"}], "+", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"], " ", "sp"}], "+", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "5"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    SuperscriptBox["b", "4"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]]}], "-", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                    SuperscriptBox["sm", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm", " ", "sp"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", "sp"}], "-", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                    SuperscriptBox["sp", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["b", "2"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "6"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", "sm"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["b", "3"], " ", "sp"}], "-", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"], " ", "sp"}], "-", 
                    RowBox[{"2", " ", "b", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", "sm", " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "7"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["b", "2"]}], " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], " ", "sm", 
                    " ", "sp"}], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Alpha]"}]], 
                    " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["sm", "2"], " ", 
                    SuperscriptBox["sp", "2"]}]}], ")"}], " ", 
                   SuperscriptBox["#1", "8"]}]}], "&"}], ",", "1"}], "]"}]}], 
             ",", 
             RowBox[{"z", "\[Rule]", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"]}]}], "}"}], ",", 
           TemplateBox[{"6"},
            "OutputSizeLimit`Skeleton"], ",", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{59., {2., 8.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{51., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{51., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 22, 33884314119192834059, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 22, 33884314119192834059, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{42., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 22, 33884314119192834059, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{77., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[33884314119192834059 === $SessionID, 
   Out[22], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.862951064242382*^9, 3.862951099866337*^9}, 
   3.862951259469585*^9, 3.862951343209405*^9, 3.862951571123252*^9, 
   3.862952486188284*^9, 3.862954165824917*^9, 3.86295426524587*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"830f55c0-bb2e-4f8e-92c4-c9dca506bbe8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "fp", "]"}]], "Input",
 CellChangeTimes->{{3.862951606488286*^9, 3.8629516077918663`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"d4e4f14f-4c15-44ba-9d4f-f629ce618225"],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.862954832643875*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"09d3c988-936d-459a-8e15-c61e73271949"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fp1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"fp", "/.", 
       RowBox[{"b", "\[Rule]", "0.25"}]}], "/.", 
      RowBox[{"\[Alpha]", "\[Rule]", "0.1"}]}], "/.", 
     RowBox[{"k", "\[Rule]", "2"}]}], "/.", 
    RowBox[{"sp", "\[Rule]", "1"}]}], "/.", 
   RowBox[{"sm", "\[Rule]", "0.5"}]}]}]], "Input",
 CellChangeTimes->{{3.8629548335798397`*^9, 3.862954882459285*^9}, {
  3.8629551532615547`*^9, 3.8629551580371113`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"45bcb00c-1841-48a8-a83a-c417bdcd94e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9999386941603592`"}], "+", 
       RowBox[{"0.01107284610546522`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9997532512710703`"}], "-", 
       RowBox[{"0.02221343226472433`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9997338771740422`"}], "-", 
       RowBox[{"0.02306891481100583`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"0.9995269346788063`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.03075559870383454`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.30957983958385055`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9508734526335446`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.0629416817925264`"}], "-", 
       RowBox[{"0.9980172066117667`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.31790344688145`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9481230924626266`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.048621345867121524`"}], "+", 
       RowBox[{"0.9988172829532473`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.41774803954359657`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9085629177208812`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.3041842680649399`"}], "-", 
       RowBox[{"0.9526132116771271`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.44819115434981954`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.8939377434489363`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.3318294076908377`"}], "+", 
       RowBox[{"0.9433394109182327`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.9987563408184462`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04985751372609332`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9972143011415615`"}], "+", 
       RowBox[{"0.07458979554041073`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.9999999980742778`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.000062060007193743`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"0.9987641971907226`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04969988340037673`", " ", "\[ImaginaryI]"}]}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8629548352585917`*^9, 3.862954919044675*^9}, 
   3.8629551787555313`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"7882fef8-4ee5-429f-8549-4bec088f42be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fp1", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.862955397924973*^9, 3.8629553991305923`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"49e900ce-e725-45aa-bbab-6f4bbfbe7828"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9999386941603592`"}], "+", 
       RowBox[{"0.01107284610546522`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9997532512710703`"}], "-", 
       RowBox[{"0.02221343226472433`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9997338771740422`"}], "-", 
       RowBox[{"0.02306891481100583`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"0.9995269346788063`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.03075559870383454`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.30957983958385055`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9508734526335446`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.0629416817925264`"}], "-", 
       RowBox[{"0.9980172066117667`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.31790344688145`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9481230924626266`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.048621345867121524`"}], "+", 
       RowBox[{"0.9988172829532473`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.41774803954359657`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9085629177208812`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.3041842680649399`"}], "-", 
       RowBox[{"0.9526132116771271`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.44819115434981954`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.8939377434489363`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.3318294076908377`"}], "+", 
       RowBox[{"0.9433394109182327`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.9987563408184462`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04985751372609332`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.9972143011415615`"}], "+", 
       RowBox[{"0.07458979554041073`", " ", "\[ImaginaryI]"}]}]}]},
    {
     RowBox[{"w", "\[Rule]", 
      RowBox[{"0.9999999980742778`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.000062060007193743`", " ", "\[ImaginaryI]"}]}]}], 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"0.9987641971907226`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04969988340037673`", " ", "\[ImaginaryI]"}]}]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.862955399324988*^9},
 CellLabel->
  "Out[43]//TableForm=",ExpressionUUID->"067a4c58-a775-4bfe-a1a4-\
59edf3a38533"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixed points: non exponentials", "Section",
 CellChangeTimes->{{3.864751357369532*^9, 3.8647513624608507`*^9}, 
   3.86481865030657*^9},ExpressionUUID->"7fe21c12-a283-487c-bb6f-\
7c4b99aaa470"],

Cell[CellGroupData[{

Cell[TextData[{
 "Simplification: assume ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "+"], "=", 
    RowBox[{
     SubscriptBox["\[Phi]", "-"], "=", 
     RowBox[{"b", "=", "0"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "29bd0bcf-f157-4e06-8fe4-d4fe1f6fbcc2"]
}], "Subsection",
 CellChangeTimes->{{3.8648186209867067`*^9, 3.864818635240849*^9}, {
  3.864819402905285*^9, 
  3.86481940340233*^9}},ExpressionUUID->"b450bac0-a6bd-4691-beff-\
8bb217611e50"],

Cell["Recover the sync state when b = 0", "Text",
 CellChangeTimes->{{3.864818815756382*^9, 
  3.86481882345897*^9}},ExpressionUUID->"9fe28944-e96e-4f2f-8156-\
8881e4654545"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"x", "-", "\[Alpha]"}], "]"}]}], "+", 
    RowBox[{"sp", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]p", "-", 
       RowBox[{"(", 
        RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"sm", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]m", "-", 
       RowBox[{"(", 
        RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vtheta", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "-", "\[Alpha]"}], "]"}]}], "+", 
    RowBox[{"sp", 
     FractionBox["k", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]p", "-", 
       RowBox[{"(", 
        RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"sm", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]m", "-", 
       RowBox[{"(", 
        RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"j", "\[Rule]", "1"}], ",", 
     RowBox[{"b", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Phi]m", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vx", ",", "vtheta"}], "}"}], "/.", "subs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fp", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"es", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Theta]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "fp", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864751377891593*^9, 3.864751493446342*^9}, {
  3.8648186377581787`*^9, 3.864818762668825*^9}, {3.864818809304653*^9, 
  3.864818812650217*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"d71d4207-57b8-471d-82f7-007cac001468"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"}, "C"]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
          TemplateBox[{"2"}, "C"]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"}, "C"]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "\[Pi]"}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"\[Pi]", "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
          TemplateBox[{"2"}, "C"]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"\[Pi]", "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "\[Pi]"}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864751500559935*^9, {3.864818711719253*^9, 3.8648187575660067`*^9}, {
   3.864818807903524*^9, 3.8648188129750233`*^9}},
 CellLabel->
  "Out[325]//TableForm=",ExpressionUUID->"d01124de-63d0-488a-a093-\
a24a1cb29c60"]
}, Open  ]],

Cell["Good. Now turn b back on", "Text",
 CellChangeTimes->{{3.864818826090785*^9, 
  3.864818833237495*^9}},ExpressionUUID->"f581a36e-2e8e-407e-bb2f-\
c13014ac653b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"x", "-", "\[Alpha]"}], "]"}]}], "+", 
    RowBox[{"sp", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]p", "-", 
       RowBox[{"(", 
        RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"sm", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]m", "-", 
       RowBox[{"(", 
        RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vtheta", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "-", "\[Alpha]"}], "]"}]}], "+", 
    RowBox[{"sp", 
     FractionBox["k", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]p", "-", 
       RowBox[{"(", 
        RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"sm", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]m", "-", 
       RowBox[{"(", 
        RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"j", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Phi]m", "\[Rule]", "0"}], ",", 
     RowBox[{"sp", "\[Rule]", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vx", ",", "vtheta"}], "}"}], "/.", "subs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fp", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"es", "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Theta]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", "fp", "]"}]}], "Input",
 CellChangeTimes->{{3.864818839117255*^9, 3.864818839512721*^9}, {
  3.86481939144074*^9, 3.864819392390604*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"f9d1e269-6f68-40c9-9eb4-b3efb777077f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.864818896779064*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"cfd02e62-4591-40d5-82f2-eeecb4525bdd"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"}, "C"]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
          TemplateBox[{"2"}, "C"]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"2", " ", "\[Pi]", " ", 
          TemplateBox[{"1"}, "C"]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "\[Pi]"}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", 
            FractionBox["\[Pi]", "2"]}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          FractionBox["\[Pi]", "2"], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"\[Pi]", "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "2"}], " ", "\[Pi]", " ", 
          TemplateBox[{"2"}, "C"]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]},
    {
     RowBox[{"x", "\[Rule]", 
      TemplateBox[{
        RowBox[{"\[Pi]", "+", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"1"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"1"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}], 
     RowBox[{"\[Theta]", "\[Rule]", 
      TemplateBox[{
        RowBox[{
          RowBox[{"-", "\[Pi]"}], "-", 
          RowBox[{"2", " ", "\[Pi]", " ", 
            TemplateBox[{"2"}, "C"]}]}], 
        RowBox[{
          TemplateBox[{"2"}, "C"], "\[Element]", 
          TemplateBox[{}, "Integers"]}]},
       "ConditionalExpression"]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.864818896796816*^9},
 CellLabel->
  "Out[331]//TableForm=",ExpressionUUID->"520fe316-e1df-4927-b02f-\
32d8af37cf0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot vector field and null clines", "Section",
 CellChangeTimes->{{3.864759355267563*^9, 3.864759355700384*^9}, {
  3.8648185702282677`*^9, 
  3.86481857864473*^9}},ExpressionUUID->"6fbc8940-e159-465d-87d8-\
89f467071600"],

Cell["\<\
1. Here I want to see where the fixed points and nullclines lie, visually. 
2. I\[CloseCurlyQuote]m hoping some tangency condition or something will \
spill out\
\>", "Text",
 CellChangeTimes->{{3.864819502697587*^9, 
  3.864819538207201*^9}},ExpressionUUID->"e80990ae-9540-4379-b03f-\
0e2d69f651f3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "b"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"x", "-", "\[Alpha]"}], "]"}]}], "+", 
    RowBox[{"sp", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]p", "-", 
       RowBox[{"(", 
        RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"sm", 
     FractionBox["j", "2"], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]m", "-", 
       RowBox[{"(", 
        RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vtheta", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "-", "\[Alpha]"}], "]"}]}], "+", 
     RowBox[{"sp", 
      FractionBox["k", "2"], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]p", "-", 
        RowBox[{"(", 
         RowBox[{"x", "+", "\[Theta]"}], ")"}]}], "]"}]}], "-", 
     RowBox[{"sm", 
      FractionBox["j", "2"], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]m", "-", 
        RowBox[{"(", 
         RowBox[{"x", "-", "\[Theta]"}], ")"}]}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"VectorPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vx", ",", "vtheta"}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "\[Rule]", "b1"}], ",", 
          RowBox[{"j", "\[Rule]", "1"}], ",", 
          RowBox[{"k", "\[Rule]", "k1"}], ",", 
          RowBox[{"sp", "\[Rule]", "sp1"}], ",", 
          RowBox[{"sm", "\[Rule]", "sm1"}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]1"}], ",", 
          RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
          RowBox[{"\[Phi]m", "\[Rule]", "\[Phi]1"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"VectorColorFunction", "\[Rule]", "Black"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p2", "=", 
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vx", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"b", "\[Rule]", "b1"}], ",", 
              RowBox[{"j", "\[Rule]", "1"}], ",", 
              RowBox[{"k", "\[Rule]", "k1"}], ",", 
              RowBox[{"sp", "\[Rule]", "sp1"}], ",", 
              RowBox[{"sm", "\[Rule]", "sm1"}], ",", 
              RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]1"}], ",", 
              RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
              RowBox[{"\[Phi]m", "\[Rule]", "\[Phi]1"}]}], "}"}]}], ")"}], 
          "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vtheta", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"b", "\[Rule]", "b1"}], ",", 
              RowBox[{"j", "\[Rule]", "1"}], ",", 
              RowBox[{"k", "\[Rule]", "k1"}], ",", 
              RowBox[{"sp", "\[Rule]", "sp1"}], ",", 
              RowBox[{"sm", "\[Rule]", "sm1"}], ",", 
              RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]1"}], ",", 
              RowBox[{"\[Phi]p", "\[Rule]", "0"}], ",", 
              RowBox[{"\[Phi]m", "\[Rule]", "\[Phi]1"}]}], "}"}]}], ")"}], 
          "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b1", ",", "0.5"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "2"}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sp1", ",", "0.9"}], "}"}], ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sm1", ",", "0.8"}], "}"}], ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]1", ",", "0.1"}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]1", ",", 
       RowBox[{"\[Pi]", "/", "3"}]}], "}"}], ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.864759363011098*^9, 3.86475950759789*^9}, {
  3.864759559439494*^9, 3.864759581751853*^9}, {3.86475961608009*^9, 
  3.8647596211005077`*^9}, {3.864759651762217*^9, 3.864759678343008*^9}, {
  3.864759713168209*^9, 3.864759719114932*^9}, {3.8647598250528603`*^9, 
  3.864759874820005*^9}, {3.8647599168155107`*^9, 3.86475992266115*^9}, {
  3.8647602782064953`*^9, 3.8647602857311287`*^9}, {3.864761110224703*^9, 
  3.864761127229928*^9}, {3.86476117327379*^9, 3.864761251927013*^9}, {
  3.864761305986175*^9, 3.864761376822379*^9}, {3.8647614530794687`*^9, 
  3.864761455764896*^9}, {3.864761750792197*^9, 3.864761870433879*^9}, {
  3.864762095508389*^9, 3.864762095807798*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"21e61dc2-298a-495e-a798-262f14172b48"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`b1$$ = 0.73, $CellContext`k1$$ = 
    1.9999999999999893`, $CellContext`sm1$$ = 0.8, $CellContext`sp1$$ = 
    0.9, $CellContext`\[Alpha]1$$ = 
    1.2566370614359172`, $CellContext`\[Phi]1$$ = 2.8525661294595324`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`b1$$], 0.5}, 0, 2}, {{
       Hold[$CellContext`k1$$], 2}, -3, 3}, {{
       Hold[$CellContext`sp1$$], 0.9}, 0, 1}, {{
       Hold[$CellContext`sm1$$], 0.8}, 0, 1}, {{
       Hold[$CellContext`\[Alpha]1$$], 0.1}, 0, 2 Pi}, {{
       Hold[$CellContext`\[Phi]1$$], Rational[1, 3] Pi}, 0, 2 Pi}}, 
    Typeset`size$$ = {360., {178., 183.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`b1$$ = 0.5, $CellContext`k1$$ = 
        2, $CellContext`sm1$$ = 0.8, $CellContext`sp1$$ = 
        0.9, $CellContext`\[Alpha]1$$ = 0.1, $CellContext`\[Phi]1$$ = 
        Rational[1, 3] Pi}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`p1 = VectorPlot[
          
          ReplaceAll[{$CellContext`vx, $CellContext`vtheta}, {$CellContext`b -> \
$CellContext`b1$$, $CellContext`j -> 
            1, $CellContext`k -> $CellContext`k1$$, $CellContext`sp -> \
$CellContext`sp1$$, $CellContext`sm -> $CellContext`sm1$$, $CellContext`\
\[Alpha] -> $CellContext`\[Alpha]1$$, $CellContext`\[Phi]p -> 
            0, $CellContext`\[Phi]m -> $CellContext`\[Phi]1$$}], \
{$CellContext`x, -Pi, Pi}, {$CellContext`\[Theta], -Pi, Pi}, 
          VectorColorFunction -> Black]; $CellContext`p2 = 
        ContourPlot[{
          ReplaceAll[$CellContext`vx, {$CellContext`b -> $CellContext`b1$$, \
$CellContext`j -> 
              1, $CellContext`k -> $CellContext`k1$$, $CellContext`sp -> \
$CellContext`sp1$$, $CellContext`sm -> $CellContext`sm1$$, $CellContext`\
\[Alpha] -> $CellContext`\[Alpha]1$$, $CellContext`\[Phi]p -> 
              0, $CellContext`\[Phi]m -> $CellContext`\[Phi]1$$}] == 0, 
           ReplaceAll[$CellContext`vtheta, {$CellContext`b -> \
$CellContext`b1$$, $CellContext`j -> 
              1, $CellContext`k -> $CellContext`k1$$, $CellContext`sp -> \
$CellContext`sp1$$, $CellContext`sm -> $CellContext`sm1$$, $CellContext`\
\[Alpha] -> $CellContext`\[Alpha]1$$, $CellContext`\[Phi]p -> 
              0, $CellContext`\[Phi]m -> $CellContext`\[Phi]1$$}] == 
           0}, {$CellContext`x, -Pi, Pi}, {$CellContext`\[Theta], -Pi, Pi}]; 
       Show[{$CellContext`p1, $CellContext`p2}]), 
      "Specifications" :> {{{$CellContext`b1$$, 0.5}, 0, 
         2}, {{$CellContext`k1$$, 2}, -3, 3}, {{$CellContext`sp1$$, 0.9}, 0, 
         1}, {{$CellContext`sm1$$, 0.8}, 0, 
         1}, {{$CellContext`\[Alpha]1$$, 0.1}, 0, 2 
         Pi}, {{$CellContext`\[Phi]1$$, Rational[1, 3] Pi}, 0, 2 Pi}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {293., 299.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.864759459738186*^9, {3.864759494854526*^9, 3.864759508212039*^9}, {
   3.864759566317841*^9, 3.8647595820987263`*^9}, {3.864759616883628*^9, 
   3.864759621465701*^9}, {3.864759669967808*^9, 3.864759719369423*^9}, {
   3.864759862540236*^9, 3.864759922945878*^9}, {3.86476028131509*^9, 
   3.8647602859568872`*^9}, {3.864761111238778*^9, 3.8647611275214643`*^9}, 
   3.8647611959086933`*^9, 3.864761252129217*^9, {3.864761308804743*^9, 
   3.864761377187511*^9}, 3.864761414591936*^9, {3.864761449926077*^9, 
   3.864761456133521*^9}, 3.864761618090914*^9, {3.864761751525865*^9, 
   3.864761779765493*^9}, 3.864761873376856*^9, 3.864761961164419*^9, 
   3.864762096240851*^9, {3.864762248704146*^9, 3.864762250614896*^9}},
 CellLabel->
  "Out[285]=",ExpressionUUID->"24b79ae9-81cd-4a65-92b0-0886ac3340b7"]
}, Open  ]],

Cell["\<\
Hmm, I see what\[CloseCurlyQuote]s happening, but its still hard to pull \
anything out analytically. \
\>", "Text",
 CellChangeTimes->{{3.86481858326186*^9, 
  3.864818594054229*^9}},ExpressionUUID->"1342d1ef-e277-41bb-a2f8-\
e13b92ba382c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.827085662179844*^9, 
  3.827085663508484*^9}},ExpressionUUID->"bac7cdb9-c16b-4feb-892a-\
7be909c78efb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rhs", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"J", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "_Real"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Ex", ",", "_Real"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"E\[Theta]", ",", " ", "_Real"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"pin", ",", " ", "_Real", ",", " ", "2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "i", ",", "j", ",", "xji", ",", "yji", ",", "thetaji", ",", 
          "inverseDistSq", ",", "inverseDist", ",", "xtemp", ",", "ytemp", 
          ",", "thetatemp", ",", "rep", ",", "A", ",", "B", ",", "C", ",", 
          "n1", ",", 
          RowBox[{"vel", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.0", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", "B", ",", "C", ",", "n1"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "10", ",", "1"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "n"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"vel", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"Ex", " ", "+", " ", 
              RowBox[{"b1", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"pin", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "-", " ", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vel", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"E\[Theta]", " ", "+", " ", 
              RowBox[{"b2", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"pin", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "i"}], "]"}], "]"}], " ", "-", " ", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}]}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "n"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", 
               RowBox[{"i", "+", "1"}]}], ",", 
              RowBox[{"j", "\[LessEqual]", "n"}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"xji", "=", 
                RowBox[{
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "j"}], "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "i"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"thetaji", "=", 
                RowBox[{
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "j"}], "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "i"}], "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"xtemp", "=", 
                RowBox[{"J", "*", 
                 RowBox[{"Sin", "[", "xji", "]"}], "*", 
                 RowBox[{
                  RowBox[{"Cos", "[", "thetaji", "]"}], "/", 
                  RowBox[{"N", "[", "n", "]"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"thetatemp", "=", 
                RowBox[{"k", "*", 
                 RowBox[{"Sin", "[", "thetaji", "]"}], "*", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xji", "]"}], "/", 
                  RowBox[{"N", "[", "n", "]"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"vel", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i"}], "]"}], "]"}], "+=", "xtemp"}], ";", 
               RowBox[{
                RowBox[{"vel", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "j"}], "]"}], "]"}], "+=", 
                RowBox[{"-", "xtemp"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"vel", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "i"}], "]"}], "]"}], "+=", "thetatemp"}], 
               ";", 
               RowBox[{
                RowBox[{"vel", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "j"}], "]"}], "]"}], "+=", 
                RowBox[{"-", "thetatemp"}]}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "vel"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"vel", "/", 
         RowBox[{"N", "[", "n", "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", "Listable"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findWs", "[", "z_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Wp", ",", "Wm", ",", "i", ",", "numOsc"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Wp", ",", "Wm"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numOsc", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"z", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numOsc"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Wp", "+=", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i"}], "]"}], "]"}], "+", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Wm", "+=", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Wp", "/", "numOsc"}], ",", 
         RowBox[{"Wm", "/", "numOsc"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotResults", "[", 
     RowBox[{"z_", ",", "pin_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "colors", ",", "Wp", ",", "Wm", ",", "p1", ",", "p2", ",", "p3", ",", 
        "p4", ",", "p5", ",", "x", ",", "\[Theta]", ",", "xin", ",", 
        "\[Theta]in"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"z", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "All"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xin", ",", "\[Theta]in"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pin", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"pin", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "All"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"750", "-", "380"}], ")"}], 
            FractionBox[
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"\[Theta]", ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "1"}], 
             RowBox[{"2", "\[Pi]"}]]}], "+", "380"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Wp", ",", "Wm"}], "}"}], "=", 
        RowBox[{"findWs", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "Swarmalators", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}], 
               "\[Transpose]"}], ",", 
              RowBox[{"VertexColors", "\[Rule]", "colors"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Order", " ", "parameters"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "Cyan", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Wp", "//", "Re"}], ",", 
               RowBox[{"Wp", "//", "Im"}]}], "}"}], "]"}], ",", "Black", ",", 
            
            RowBox[{"Text", "[", 
             RowBox[{"\"\<W+\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Wp", "//", "Re"}], ",", 
                RowBox[{"Wp", "//", "Im"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "Magenta", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Wm", "//", "Re"}], ",", 
               RowBox[{"Wm", "//", "Im"}]}], "}"}], "]"}], ",", "Black", ",", 
            
            RowBox[{"Text", "[", 
             RowBox[{"\"\<W-\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Wm", "//", "Re"}], ",", 
                RowBox[{"Wm", "//", "Im"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "Black", ",", 
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.25"}], ",", "1.25"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.25"}], ",", "1.25"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "20"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Scatter", " ", "plot", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{"x", ",", "theta"}], ")"}], " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "//", "mod"}], ",", 
             RowBox[{"\[Theta]", "//", "mod"}]}], "}"}], "\[Transpose]"}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Theta]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Scatter", " ", "plot", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{"\[Xi]", ",", "\[Theta]"}], ")"}], " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "\[Theta]"}], ",", 
              RowBox[{"x", "-", "\[Theta]"}]}], "}"}], "\[Transpose]"}], "//",
            "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Xi]\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Eta]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p4", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "xin"}], "}"}], "\[Transpose]"}], "//", 
           "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Beta]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p5", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Theta]in"}], "}"}], "\[Transpose]"}],
            "//", "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Theta]\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Alpha]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "}"}], 
          "}"}], "]"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eulerStep", "[", 
     RowBox[{
     "z_", ",", "F_", ",", "dt_", ",", "J_", ",", "k_", ",", "Ex_", ",", 
      "E\[Theta]_", ",", "pin_", ",", "b1_", ",", "b2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"znew", ",", "n", ",", "i", ",", "j", ",", "vel"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"znew", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Dimensions", "[", "z", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "z", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vel", "=", 
        RowBox[{"F", "[", 
         RowBox[{
         "z", ",", "n", ",", "J", ",", "k", ",", "Ex", ",", "E\[Theta]", ",", 
          "pin", ",", "b1", ",", "b2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"znew", "=", 
        RowBox[{"z", "+", 
         RowBox[{"dt", "*", "vel"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "znew", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rk4", "[", 
     RowBox[{
     "z_", ",", "F_", ",", "dt_", ",", "J_", ",", "k_", ",", "Ex_", ",", 
      "E\[Theta]_", ",", "pin_", ",", "b1_", ",", "b2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "znew", ",", "n", ",", "i", ",", "j", ",", "k1", ",", "k2", ",", "k3", 
        ",", "k4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"znew", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Dimensions", "[", "z", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "z", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k1", "=", 
        RowBox[{"F", "[", 
         RowBox[{
         "z", ",", "n", ",", "J", ",", "k", ",", "Ex", ",", "E\[Theta]", ",", 
          "pin", ",", "b1", ",", "b2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"k2", "=", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"z", "+", 
           RowBox[{
            FractionBox["dt", "2"], "k1"}]}], ",", "n", ",", "J", ",", "k", 
          ",", "Ex", ",", "E\[Theta]", ",", "pin", ",", "b1", ",", "b2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k3", "=", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"z", "+", 
           RowBox[{
            FractionBox["dt", "2"], "k2"}]}], ",", "n", ",", "J", ",", "k", 
          ",", "Ex", ",", "E\[Theta]", ",", "pin", ",", "b1", ",", "b2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k4", "=", 
        RowBox[{"F", "[", 
         RowBox[{
          RowBox[{"z", "+", 
           RowBox[{"dt", " ", "k3"}]}], ",", "n", ",", "J", ",", "k", ",", 
          "Ex", ",", "E\[Theta]", ",", "pin", ",", "b1", ",", "b2"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"z", "+", 
         RowBox[{
          FractionBox["dt", "6"], 
          RowBox[{"(", 
           RowBox[{"k1", "+", 
            RowBox[{"2", "k2"}], "+", 
            RowBox[{"2", "k3"}], "+", "k4"}], ")"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mod", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"Return", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "\[Pi]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findMeanV", "[", 
     RowBox[{"znew_", ",", "z_", ",", "dt_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"znew", "-", "z"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "All"}], "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"v", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "All"}], "]"}], "]"}], "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Mean", "[", "v", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findGamma", "[", 
     RowBox[{"xs_", ",", "\[Theta]s_", ",", "cutoff_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "gammas", ",", "i", ",", "n", ",", "x", ",", "\[Theta]", ",", 
        "xSteady", ",", "rangeSteadyX", ",", "gammaX", ",", "\[Theta]Steady", 
        ",", "rangeSteady\[Theta]", ",", "gamma\[Theta]", ",", "index"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Find", " ", "fraction", " ", "of", " ", "swarmalators", " ", "that", 
         " ", "have", " ", "completed", " ", "at", " ", "least", " ", 
         "\[IndentingNewLine]", " ", "one", " ", "full", " ", "oscillation", 
         " ", 
         RowBox[{"(", 
          RowBox[{"0", ",", 
           RowBox[{"2", "\[Pi]"}]}], ")"}], " ", "mod", " ", "2", "\[Pi]"}], 
        ",", " ", 
        RowBox[{
        "after", " ", "transients", " ", "have", " ", "been", " ", 
         "discarded"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "xs", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gammas", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Theta]"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xs", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"\[Theta]s", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "for", " ", "one", " ", "loop", " ", "when", " ", 
            "x", " ", "has", " ", "approximately", " ", "achieved", " ", 
            "its", " ", "steady", " ", "state"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"xSteady", "=", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"cutoff", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rangeSteadyX", "=", 
           RowBox[{
            RowBox[{"Max", "[", "xSteady", "]"}], "-", 
            RowBox[{"Min", "[", "xSteady", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gammaX", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rangeSteadyX", ">=", 
              RowBox[{"2", "\[Pi]"}]}], ",", "1", ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "for", " ", "one", " ", "loop", " ", "when", " ", 
            "\[Theta]", " ", "has", " ", "approximately", " ", "achieved", 
            " ", "its", " ", "steady", " ", "state"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]Steady", "=", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", 
             RowBox[{"cutoff", ";;", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rangeSteady\[Theta]", "=", 
           RowBox[{
            RowBox[{"Max", "[", "\[Theta]Steady", "]"}], "-", 
            RowBox[{"Min", "[", "\[Theta]Steady", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"gamma\[Theta]", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rangeSteady\[Theta]", ">=", 
              RowBox[{"2", "\[Pi]"}]}], ",", "1", ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Require", " ", "both", " ", "to", " ", "be", " ", "true"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"gammas", ",", 
            RowBox[{"gammaX", "*", "gamma\[Theta]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Return", " ", "fraction", " ", "of", " ", "swarmalators", " ", 
          "with", " ", "gamma"}], " ", "=", " ", "1"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Mean", "[", "gammas", "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotResults", "[", 
     RowBox[{"z_", ",", "pin_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "colors", ",", "Wp", ",", "Wm", ",", "p1", ",", "p2", ",", "p3", ",", 
        "p4", ",", "p5", ",", "x", ",", "\[Theta]", ",", "xin", ",", 
        "\[Theta]in", ",", "x1", ",", "\[Theta]1", ",", "x2", ",", 
        "\[Theta]2", ",", "\[Xi]1", ",", "\[Xi]2", ",", "\[Eta]1", ",", 
        "\[Eta]2", ",", "index", ",", "n"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Theta]"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"z", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "All"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xin", ",", "\[Theta]in"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pin", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "All"}], "]"}], "]"}], ",", 
          RowBox[{"pin", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "All"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{
         RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"750", "-", "380"}], ")"}], 
            FractionBox[
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"\[Theta]", ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}], "-", "1"}], 
             RowBox[{"2", "\[Pi]"}]]}], "+", "380"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Wp", ",", "Wm"}], "}"}], "=", 
        RowBox[{"findWs", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", "Swarmalators", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "All"}], "]"}], "]"}], "]"}]}], "}"}], 
               "\[Transpose]"}], ",", 
              RowBox[{"VertexColors", "\[Rule]", "colors"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Order", " ", "parameters"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "Cyan", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Wp", "//", "Re"}], ",", 
               RowBox[{"Wp", "//", "Im"}]}], "}"}], "]"}], ",", "Black", ",", 
            
            RowBox[{"Text", "[", 
             RowBox[{"\"\<W+\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Wp", "//", "Re"}], ",", 
                RowBox[{"Wp", "//", "Im"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "Magenta", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Wm", "//", "Re"}], ",", 
               RowBox[{"Wm", "//", "Im"}]}], "}"}], "]"}], ",", "Black", ",", 
            
            RowBox[{"Text", "[", 
             RowBox[{"\"\<W-\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Wm", "//", "Re"}], ",", 
                RowBox[{"Wm", "//", "Im"}]}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "Black", ",", 
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.25"}], ",", "1.25"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.25"}], ",", "1.25"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "20"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Scatter", " ", "plot", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{"x", ",", "theta"}], ")"}], " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"index", "=", 
        RowBox[{"Round", "[", 
         RowBox[{"n", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "\[Theta]1"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x2", ",", "\[Theta]2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "index", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", "index", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "//", "mod"}], ",", 
             RowBox[{"\[Theta]", "//", "mod"}]}], "}"}], "\[Transpose]"}], 
          ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Theta]\>\"", ",", "15"}], "]"}]}], "}"}]}], ",", 
          
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Cyan", ",", 
             RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x1", ",", "\[Theta]1"}], "}"}], "//", "mod"}], "]"}],
              ",", "Magenta", ",", 
             RowBox[{"Point", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x2", ",", "\[Theta]2"}], "}"}], "//", "mod"}], 
              "]"}]}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Scatter", " ", "plot", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{"\[Xi]", ",", "\[Theta]"}], ")"}], " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Xi]1", ",", "\[Eta]1"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Xi]2", ",", "\[Eta]2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "index", "]"}], "]"}], "+", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "index", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "index", "]"}], "]"}], "-", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "index", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", "\[Theta]"}], ",", 
              RowBox[{"x", "-", "\[Theta]"}]}], "}"}], "\[Transpose]"}], "//",
            "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Xi]\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Eta]\>\"", ",", "15"}], "]"}]}], "}"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Cyan", ",", 
             RowBox[{"PointSize", "[", "0.025", "]"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Xi]1", ",", "\[Eta]1"}], "}"}], "//", "mod"}], 
              "]"}], ",", "Magenta", ",", 
             RowBox[{"Point", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Xi]2", ",", "\[Eta]2"}], "}"}], "//", "mod"}], 
              "]"}]}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p4", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "xin"}], "}"}], "\[Transpose]"}], "//", 
           "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<x\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Beta]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p5", "=", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Theta]in"}], "}"}], "\[Transpose]"}],
            "//", "mod"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "}"}]}], ",", 
          
          RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Theta]\>\"", ",", "15"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[Alpha]\>\"", ",", "15"}], "]"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "}"}], 
          "}"}], "]"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simplifyExponents", "[", "eqn_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{"eqn", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Exp", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Exp", "[", 
         RowBox[{"Together", "@", 
          RowBox[{"FullSimplify", "[", "x", "]"}]}], "]"}]}], "}"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", "=", 
   RowBox[{"simplifyExponents", "[", "eqn", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.771809772019354*^9, 3.771809804659128*^9}, {
   3.771809852939666*^9, 3.771809860937518*^9}, {3.771809944760911*^9, 
   3.771809948329599*^9}, {3.771809988831056*^9, 3.7718100261270638`*^9}, {
   3.771810066375538*^9, 3.7718100825338984`*^9}, 3.7718101600330153`*^9, {
   3.771810371699485*^9, 3.77181048448105*^9}, {3.77181098613233*^9, 
   3.771810990059856*^9}, {3.7718111209646473`*^9, 3.771811144298716*^9}, {
   3.823362231813129*^9, 3.823362263218461*^9}, {3.823362371650951*^9, 
   3.8233623880093937`*^9}, {3.823362746840467*^9, 3.8233628560051928`*^9}, {
   3.823363245501026*^9, 3.823363317989832*^9}, {3.823363401523355*^9, 
   3.823363425055969*^9}, {3.823367826975328*^9, 3.8233678419387302`*^9}, {
   3.823367886962386*^9, 3.8233679007838993`*^9}, {3.823940510715972*^9, 
   3.823940512701393*^9}, {3.824850374938758*^9, 3.824850376261614*^9}, {
   3.82500157550377*^9, 3.825001612145797*^9}, {3.825009936254222*^9, 
   3.825009954900168*^9}, {3.826565294104487*^9, 3.826565302808567*^9}, 
   3.826566936442206*^9, 3.826937388383469*^9, {3.827085673883617*^9, 
   3.827085690247054*^9}, {3.8281385192278957`*^9, 3.8281385197212057`*^9}, {
   3.828138959119141*^9, 3.82813897159617*^9}, {3.837541383859211*^9, 
   3.837541554315774*^9}, {3.837541609723694*^9, 3.8375416664848127`*^9}, {
   3.8539207500811243`*^9, 3.853920887110381*^9}, {3.853920920714904*^9, 
   3.8539209749732533`*^9}, {3.85821827830324*^9, 3.858218311966076*^9}, {
   3.858218872602203*^9, 3.858218908091454*^9}, 3.858219172699078*^9, {
   3.85821958915513*^9, 3.85821970352384*^9}, {3.858220614446547*^9, 
   3.85822062643115*^9}, {3.8582207105325727`*^9, 3.858220735413794*^9}, {
   3.8582207700520763`*^9, 3.8582208206913*^9}, {3.858220922353057*^9, 
   3.858221039401771*^9}, {3.858226817057226*^9, 3.858226858409651*^9}, {
   3.858226958760968*^9, 3.858227090030776*^9}, {3.85822728188105*^9, 
   3.858227388715498*^9}, {3.858227783287352*^9, 3.8582278107566967`*^9}, {
   3.858227849701407*^9, 3.85822785204843*^9}, {3.858229373032332*^9, 
   3.858229380539322*^9}, {3.858229473068803*^9, 3.858229488562467*^9}, {
   3.858229716289852*^9, 3.8582297652026873`*^9}, {3.85987031867843*^9, 
   3.85987043096795*^9}, {3.8598806442967052`*^9, 3.859880649569186*^9}, {
   3.859882642172611*^9, 3.8598826689824944`*^9}, {3.859882702604845*^9, 
   3.859882743879847*^9}, {3.861339110189502*^9, 3.861339312843608*^9}, {
   3.861339389575227*^9, 3.861339470256692*^9}, {3.861339579114222*^9, 
   3.861339583799417*^9}, {3.861340406313528*^9, 3.861340423494424*^9}, {
   3.8618535650610247`*^9, 3.861853581377734*^9}, {3.86448933633954*^9, 
   3.8644894316651497`*^9}, {3.8648188949872103`*^9, 3.8648188952715807`*^9}},
 
 CellLabel->
  "In[332]:=",ExpressionUUID->"089a75fa-ae34-4a0f-b36f-8ddb4fa21b65"]
}, Open  ]]
},
Evaluator->"Alternal kernel",
WindowSize->{1724, 983},
WindowMargins->{{Automatic, 0}, {Automatic, 4}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2399d33b-261b-4e67-b792-da0abab15534"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 159, 3, 67, "Section",ExpressionUUID->"bbdf1c67-7c07-464c-9dea-dd1ce40e9098"],
Cell[742, 27, 477, 9, 35, "Text",ExpressionUUID->"150ede99-bd58-4f5d-9d77-60e362fa9b38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1256, 41, 160, 3, 67, "Section",ExpressionUUID->"172b6825-64c5-493e-8d5c-2bdf4881ad52"],
Cell[CellGroupData[{
Cell[1441, 48, 161, 3, 54, "Subsection",ExpressionUUID->"9cfc27a6-c0d8-43b5-b8a0-6951a153c00f"],
Cell[CellGroupData[{
Cell[1627, 55, 4557, 130, 472, "Input",ExpressionUUID->"cebf396b-dd37-4c2b-bec3-df07c761872a"],
Cell[6187, 187, 258, 6, 34, "Output",ExpressionUUID->"a1527836-81ec-4e32-91d3-1c91d3b194d2"],
Cell[6448, 195, 326, 6, 393, "Output",ExpressionUUID->"dc3dfb2c-2cb1-4e17-94cf-4cf382ff489c"],
Cell[6777, 203, 214, 4, 34, "Output",ExpressionUUID->"833503bc-0165-45bf-84fa-d2282d59bdbb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7040, 213, 216, 4, 54, "Subsection",ExpressionUUID->"2ff92a82-3890-4af4-a315-0ddce8ebaf72"],
Cell[7259, 219, 5910, 162, 472, "Input",ExpressionUUID->"c008f08a-2d3f-47ab-a43a-58420013416a"],
Cell[CellGroupData[{
Cell[13194, 385, 2293, 64, 52, "Input",ExpressionUUID->"5e3a04ff-1fca-4ba3-9945-ede260cd44ed"],
Cell[15490, 451, 16006, 332, 234, "Output",ExpressionUUID->"fb54cbac-7c9c-4ba7-a410-60e5b11abd06"]
}, Open  ]],
Cell[31511, 786, 580, 18, 35, "Text",ExpressionUUID->"4dd082f7-1657-4f70-a5f4-a788e93fdef3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32140, 810, 277, 4, 67, "Section",ExpressionUUID->"ff4b5534-c451-444b-be19-aa8b138f9f7d"],
Cell[32420, 816, 204, 3, 35, "Text",ExpressionUUID->"56084902-fdfc-408b-b118-dfb23a05ee1e"],
Cell[CellGroupData[{
Cell[32649, 823, 6672, 186, 243, "Input",ExpressionUUID->"b303af35-7a48-4308-b8c9-02e38ee0a7c6"],
Cell[39324, 1011, 4108, 105, 72, "Output",ExpressionUUID->"c721451f-3fbf-4e4f-be9c-fd6743fc2edf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43469, 1121, 167, 3, 45, "Subsubsection",ExpressionUUID->"0928f760-a724-4615-bfde-3e9cf9114d59"],
Cell[CellGroupData[{
Cell[43661, 1128, 249, 6, 30, "Input",ExpressionUUID->"9fabe89b-96c6-49f5-9e6f-15c908559303"],
Cell[43913, 1136, 1547, 46, 37, "Output",ExpressionUUID->"62e61220-7ff6-4655-a69e-ec862827c8f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45497, 1187, 589, 14, 30, "Input",ExpressionUUID->"18ed0232-8555-43a7-8de0-b5a441cf348f"],
Cell[46089, 1203, 5218, 147, 242, "Output",ExpressionUUID->"a14af793-0546-4bbf-9696-2d1a3d09325f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51344, 1355, 673, 18, 30, "Input",ExpressionUUID->"4d3b187f-a78c-452f-84b6-6fea2c54c278"],
Cell[52020, 1375, 430, 9, 63, "Output",ExpressionUUID->"3fcdebee-1515-4453-aad1-2e18fe4c352a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[52499, 1390, 228, 4, 37, "Subsubsection",ExpressionUUID->"5ba74483-bf5e-4ecc-8225-0bd0191fb14c"],
Cell[CellGroupData[{
Cell[52752, 1398, 669, 19, 52, "Input",ExpressionUUID->"28ee950d-13a1-4706-a130-eeaa9d9bdd41"],
Cell[53424, 1419, 21098, 479, 184, "Output",ExpressionUUID->"830f55c0-bb2e-4f8e-92c4-c9dca506bbe8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74559, 1903, 207, 3, 30, "Input",ExpressionUUID->"d4e4f14f-4c15-44ba-9d4f-f629ce618225"],
Cell[74769, 1908, 149, 2, 34, "Output",ExpressionUUID->"09d3c988-936d-459a-8e15-c61e73271949"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74955, 1915, 558, 14, 30, "Input",ExpressionUUID->"45bcb00c-1841-48a8-a83a-c417bdcd94e5"],
Cell[75516, 1931, 3247, 85, 77, "Output",ExpressionUUID->"7882fef8-4ee5-429f-8549-4bec088f42be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78800, 2021, 207, 3, 30, "Input",ExpressionUUID->"49e900ce-e725-45aa-bbab-6f4bbfbe7828"],
Cell[79010, 2026, 3182, 80, 162, "Output",ExpressionUUID->"067a4c58-a775-4bfe-a1a4-59edf3a38533"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[82253, 2113, 199, 3, 53, "Section",ExpressionUUID->"7fe21c12-a283-487c-bb6f-7c4b99aaa470"],
Cell[CellGroupData[{
Cell[82477, 2120, 509, 15, 54, "Subsection",ExpressionUUID->"b450bac0-a6bd-4691-beff-8bb217611e50"],
Cell[82989, 2137, 174, 3, 35, "Text",ExpressionUUID->"9fe28944-e96e-4f2f-8156-8881e4654545"],
Cell[CellGroupData[{
Cell[83188, 2144, 2225, 71, 195, "Input",ExpressionUUID->"d71d4207-57b8-471d-82f7-007cac001468"],
Cell[85416, 2217, 6022, 182, 298, "Output",ExpressionUUID->"d01124de-63d0-488a-a093-a24a1cb29c60"]
}, Open  ]],
Cell[91453, 2402, 166, 3, 35, "Text",ExpressionUUID->"f581a36e-2e8e-407e-bb2f-c13014ac653b"],
Cell[CellGroupData[{
Cell[91644, 2409, 2151, 70, 174, "Input",ExpressionUUID->"f9d1e269-6f68-40c9-9eb4-b3efb777077f"],
Cell[93798, 2481, 160, 3, 34, "Output",ExpressionUUID->"cfd02e62-4591-40d5-82f2-eeecb4525bdd"],
Cell[93961, 2486, 5919, 180, 298, "Output",ExpressionUUID->"520fe316-e1df-4927-b02f-32d8af37cf0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99941, 2673, 228, 4, 67, "Section",ExpressionUUID->"6fbc8940-e159-465d-87d8-89f467071600"],
Cell[100172, 2679, 310, 7, 58, "Text",ExpressionUUID->"e80990ae-9540-4379-b03f-0e2d69f651f3"],
Cell[CellGroupData[{
Cell[100507, 2690, 5808, 153, 321, "Input",ExpressionUUID->"21e61dc2-298a-495e-a798-262f14172b48"],
Cell[106318, 2845, 4625, 82, 611, "Output",ExpressionUUID->"24b79ae9-81cd-4a65-92b0-0886ac3340b7"]
}, Open  ]],
Cell[110958, 2930, 251, 6, 35, "Text",ExpressionUUID->"1342d1ef-e277-41bb-a2f8-e13b92ba382c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111246, 2941, 154, 3, 67, "Section",ExpressionUUID->"bac7cdb9-c16b-4feb-892a-7be909c78efb"],
Cell[111403, 2946, 45797, 1141, 3726, "Input",ExpressionUUID->"089a75fa-ae34-4a0f-b36f-8ddb4fa21b65"]
}, Open  ]]
}
]
*)

